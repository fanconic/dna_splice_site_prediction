Standard Training.
2021-04-25 13:26:20.078381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
preprocessing data...
2021-04-25 13:26:25.652344: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-25 13:26:25.654731: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-25 13:26:25.719585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:0d:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-04-25 13:26:25.719637: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-25 13:26:25.733679: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-25 13:26:25.733817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-25 13:26:25.744511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-25 13:26:25.751591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-25 13:26:25.774019: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-25 13:26:25.781360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-25 13:26:25.783063: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-25 13:26:25.802104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-25 13:26:25.802738: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 13:26:25.803489: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-25 13:26:25.808123: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:0d:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-04-25 13:26:25.808165: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-25 13:26:25.808199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-25 13:26:25.808228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-25 13:26:25.808255: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-25 13:26:25.808281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-25 13:26:25.808308: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-25 13:26:25.808334: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-25 13:26:25.808360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-25 13:26:25.816110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-25 13:26:25.816954: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-25 13:26:27.146437: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-25 13:26:27.146490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-25 13:26:27.146502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-25 13:26:27.156182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10271 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:0d:00.0, compute capability: 6.1)
/cluster/home/fanconic/.local/lib/python3.7/site-packages/sklearn/utils/validation.py:72: FutureWarning: Pass classes=[0 1], y=[0 0 0 ... 0 0 0] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  "will result in an error", FutureWarning)
### fitting model SpliceAI80 ###
2021-04-25 13:26:27.563278: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-25 13:26:28.090895: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-25 13:26:28.107918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Model: "splice_a_i80"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv1d (Conv1D)              multiple                  160       
_________________________________________________________________
conv1d_1 (Conv1D)            multiple                  1056      
_________________________________________________________________
conv1d_2 (Conv1D)            multiple                  1056      
_________________________________________________________________
conv1d_3 (Conv1D)            multiple                  33        
_________________________________________________________________
res_block (ResBlock)         multiple                  22848     
_________________________________________________________________
res_block_1 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_2 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_3 (ResBlock)       multiple                  22848     
_________________________________________________________________
cropping1d (Cropping1D)      multiple                  0         
=================================================================
Total params: 93,697
Trainable params: 93,185
Non-trainable params: 512
_________________________________________________________________
None
2021-04-25 13:26:31.863882: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-25 13:26:31.864724: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2200055000 Hz
Epoch 1/15
6/6 - 5s - loss: 0.4614 - auc: 0.4902 - val_loss: 0.4818 - val_auc: 0.4892
val auprc:  0.4909668198619304
Epoch 2/15
6/6 - 0s - loss: 0.1070 - auc: 0.9105 - val_loss: 0.3247 - val_auc: 0.6507
val auprc:  0.6531896116184769
Epoch 3/15
6/6 - 0s - loss: 0.0458 - auc: 0.9608 - val_loss: 0.2824 - val_auc: 0.7724
val auprc:  0.7709378905270645
Epoch 4/15
6/6 - 0s - loss: 0.0276 - auc: 0.9964 - val_loss: 0.2463 - val_auc: 0.8189
val auprc:  0.8186251230893401
Epoch 5/15
6/6 - 0s - loss: 0.0215 - auc: 0.9969 - val_loss: 0.2326 - val_auc: 0.8147
val auprc:  0.8142368411058113
Epoch 6/15
6/6 - 0s - loss: 0.0246 - auc: 0.9869 - val_loss: 0.2209 - val_auc: 0.8180
val auprc:  0.8209956551107683
Epoch 7/15
6/6 - 0s - loss: 0.0127 - auc: 0.9994 - val_loss: 0.2167 - val_auc: 0.8357
val auprc:  0.8361758031528663
Epoch 8/15
6/6 - 0s - loss: 0.0091 - auc: 0.9999 - val_loss: 0.2124 - val_auc: 0.8445
val auprc:  0.843106953665662
Epoch 9/15
6/6 - 0s - loss: 0.0074 - auc: 1.0000 - val_loss: 0.2096 - val_auc: 0.8483
val auprc:  0.8508519955100685
Epoch 10/15
6/6 - 0s - loss: 0.0068 - auc: 1.0000 - val_loss: 0.2072 - val_auc: 0.8554
val auprc:  0.8563822636435994
Epoch 11/15
6/6 - 0s - loss: 0.0064 - auc: 1.0000 - val_loss: 0.2053 - val_auc: 0.8586
val auprc:  0.8575311252013654
Epoch 12/15
6/6 - 0s - loss: 0.0063 - auc: 1.0000 - val_loss: 0.2038 - val_auc: 0.8584
val auprc:  0.8604498248834609
Epoch 13/15
6/6 - 0s - loss: 0.0062 - auc: 1.0000 - val_loss: 0.2028 - val_auc: 0.8544
val auprc:  0.854234917865869
Epoch 14/15
6/6 - 0s - loss: 0.0062 - auc: 1.0000 - val_loss: 0.2021 - val_auc: 0.8535
val auprc:  0.8526702282324947
Epoch 15/15
6/6 - 0s - loss: 0.0064 - auc: 1.0000 - val_loss: 0.2018 - val_auc: 0.8535
val auprc:  0.8540425884297892
### performance on valdiation set ###
########### Precision : 0.8750, Recall: 0.5250, F1: 0.6563, AUROC: 0.9842, AUPRC: 0.8575 ###########
### performance on testing set ###
########### Precision : 0.8571, Recall: 0.4500, F1: 0.5902, AUROC: 0.9616, AUPRC: 0.7318 ###########
### fitting model SpliceAI400 ###
Model: "splice_a_i400"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv1d_12 (Conv1D)           multiple                  160       
_________________________________________________________________
conv1d_13 (Conv1D)           multiple                  1056      
_________________________________________________________________
conv1d_14 (Conv1D)           multiple                  1056      
_________________________________________________________________
conv1d_15 (Conv1D)           multiple                  1056      
_________________________________________________________________
conv1d_16 (Conv1D)           multiple                  33        
_________________________________________________________________
res_block_4 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_5 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_6 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_7 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_8 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_9 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_10 (ResBlock)      multiple                  22848     
_________________________________________________________________
res_block_11 (ResBlock)      multiple                  22848     
_________________________________________________________________
cropping1d_1 (Cropping1D)    multiple                  0         
=================================================================
Total params: 186,145
Trainable params: 185,121
Non-trainable params: 1,024
_________________________________________________________________
None
Epoch 1/15
6/6 - 7s - loss: 4.1824 - auc: 0.1153 - val_loss: 0.3249 - val_auc: 0.2375
val auprc:  0.23440697334789473
Epoch 2/15
6/6 - 0s - loss: 0.8549 - auc: 0.4560 - val_loss: 0.4062 - val_auc: 0.4584
val auprc:  0.4562570397406306
Epoch 3/15
6/6 - 0s - loss: 0.4070 - auc: 0.6473 - val_loss: 0.2711 - val_auc: 0.5478
val auprc:  0.5436458147950239
Epoch 4/15
6/6 - 0s - loss: 0.2665 - auc: 0.7643 - val_loss: 0.2945 - val_auc: 0.5869
val auprc:  0.5863275753127549
Epoch 5/15
6/6 - 0s - loss: 0.1561 - auc: 0.8439 - val_loss: 0.2579 - val_auc: 0.5890
val auprc:  0.5871842292338519
Epoch 6/15
6/6 - 0s - loss: 0.0981 - auc: 0.8957 - val_loss: 0.2571 - val_auc: 0.6178
val auprc:  0.6173637524268931
Epoch 7/15
6/6 - 0s - loss: 0.0815 - auc: 0.9052 - val_loss: 0.2423 - val_auc: 0.6269
val auprc:  0.62745446829233
Epoch 8/15
6/6 - 0s - loss: 0.0553 - auc: 0.9351 - val_loss: 0.2330 - val_auc: 0.6325
val auprc:  0.629478820351791
Epoch 9/15
6/6 - 0s - loss: 0.0489 - auc: 0.9443 - val_loss: 0.2217 - val_auc: 0.6435
val auprc:  0.6402512266393064
Epoch 10/15
6/6 - 0s - loss: 0.0409 - auc: 0.9519 - val_loss: 0.2129 - val_auc: 0.6563
val auprc:  0.6579051714915775
Epoch 11/15
6/6 - 0s - loss: 0.0366 - auc: 0.9684 - val_loss: 0.2066 - val_auc: 0.6587
val auprc:  0.6592875071259348
Epoch 12/15
6/6 - 0s - loss: 0.0342 - auc: 0.9696 - val_loss: 0.2022 - val_auc: 0.6564
val auprc:  0.6551842242402967
Epoch 13/15
6/6 - 0s - loss: 0.0324 - auc: 0.9714 - val_loss: 0.1990 - val_auc: 0.6572
val auprc:  0.6561524773154077
Epoch 14/15
6/6 - 0s - loss: 0.0323 - auc: 0.9711 - val_loss: 0.1966 - val_auc: 0.6535
val auprc:  0.6542247446669932
Epoch 15/15
6/6 - 0s - loss: 0.0323 - auc: 0.9631 - val_loss: 0.1948 - val_auc: 0.6556
val auprc:  0.6533902005945844
### performance on valdiation set ###
########### Precision : 0.5000, Recall: 0.0250, F1: 0.0476, AUROC: 0.9561, AUPRC: 0.6593 ###########
### performance on testing set ###
########### Precision : 0.5000, Recall: 0.0250, F1: 0.0476, AUROC: 0.9200, AUPRC: 0.5317 ###########
### training completed ###
2021-04-25 13:27:01.763923: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
preprocessing data...
2021-04-25 13:27:05.670296: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-25 13:27:05.671664: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-04-25 13:27:05.717533: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:0d:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-04-25 13:27:05.717581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-25 13:27:05.721384: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-25 13:27:05.721435: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-25 13:27:05.723152: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-25 13:27:05.723575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-25 13:27:05.727297: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-25 13:27:05.728206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-25 13:27:05.728492: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-25 13:27:05.731455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-25 13:27:05.731951: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-25 13:27:05.732732: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-25 13:27:05.734464: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:0d:00.0 name: GeForce GTX 1080 Ti computeCapability: 6.1
coreClock: 1.582GHz coreCount: 28 deviceMemorySize: 10.92GiB deviceMemoryBandwidth: 451.17GiB/s
2021-04-25 13:27:05.734503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-25 13:27:05.734526: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-25 13:27:05.734548: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-25 13:27:05.734567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-04-25 13:27:05.734586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-04-25 13:27:05.734605: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-04-25 13:27:05.734624: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-04-25 13:27:05.734644: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-04-25 13:27:05.739933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-04-25 13:27:05.739974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-04-25 13:27:06.464375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-25 13:27:06.464613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-04-25 13:27:06.464626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-04-25 13:27:06.472707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10271 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:0d:00.0, compute capability: 6.1)
### loading model SpliceAI80 ###
2021-04-25 13:27:06.822883: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-04-25 13:27:07.153910: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-04-25 13:27:07.164040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
Model: "splice_a_i80"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv1d (Conv1D)              multiple                  160       
_________________________________________________________________
conv1d_1 (Conv1D)            multiple                  1056      
_________________________________________________________________
conv1d_2 (Conv1D)            multiple                  1056      
_________________________________________________________________
conv1d_3 (Conv1D)            multiple                  33        
_________________________________________________________________
res_block (ResBlock)         multiple                  22848     
_________________________________________________________________
res_block_1 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_2 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_3 (ResBlock)       multiple                  22848     
_________________________________________________________________
cropping1d (Cropping1D)      multiple                  0         
=================================================================
Total params: 93,697
Trainable params: 93,185
Non-trainable params: 512
_________________________________________________________________
None
2021-04-25 13:27:08.736180: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-04-25 13:27:08.736822: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2200055000 Hz
### predictions saved ###
### loading model SpliceAI400 ###
Model: "splice_a_i400"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv1d_12 (Conv1D)           multiple                  160       
_________________________________________________________________
conv1d_13 (Conv1D)           multiple                  1056      
_________________________________________________________________
conv1d_14 (Conv1D)           multiple                  1056      
_________________________________________________________________
conv1d_15 (Conv1D)           multiple                  1056      
_________________________________________________________________
conv1d_16 (Conv1D)           multiple                  33        
_________________________________________________________________
res_block_4 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_5 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_6 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_7 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_8 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_9 (ResBlock)       multiple                  22848     
_________________________________________________________________
res_block_10 (ResBlock)      multiple                  22848     
_________________________________________________________________
res_block_11 (ResBlock)      multiple                  22848     
_________________________________________________________________
cropping1d_1 (Cropping1D)    multiple                  0         
=================================================================
Total params: 186,145
Trainable params: 185,121
Non-trainable params: 1,024
_________________________________________________________________
None
### predictions saved ###
### process completed ###
Script completed!
